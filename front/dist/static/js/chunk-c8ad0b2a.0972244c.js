(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c8ad0b2a"],{"2a41":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("skContainerAside",{attrs:{heardHeight:e.heardHeight,footerHeight:e.footerHeight},scopedSlots:e._u([{key:"header",fn:function(){return[e.isBreadcrumb?i("skBreadcrumb",{attrs:{list:e.breadcrumbList}}):e._e()]},proxy:!0},{key:"aside",fn:function(){return[i("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),i("div",{style:{overflowY:"scroll",height:e.treeHeight+"px"}},[i("el-tree",{ref:"newTree",attrs:{data:e.menuTreeData,"node-key":e.treeConfig.searchId,props:e.treeConfig.defaultProps,"filter-node-method":e.filterNode,"default-expanded-keys":e.checked,"highlight-current":!0},on:{"node-click":e.onNodeClick}})],1)]},proxy:!0},{key:"default",fn:function(){return[i("div",{staticClass:"clickLabelStyle"},[i("span",{staticStyle:{"font-size":"13px",color:"#878787"}},[e._v(e._s(e.clickLabel))]),i("span",{staticClass:"clickLabelValueStyle"},[e._v(e._s(e.clickLabelValue))]),e.clickLabelTag.value?i("el-tag",{attrs:{type:e.clickLabelTag.type,size:"mini"}},[e._v(e._s(e.clickLabelTag.value))]):e._e()],1),i("vxe-form",{ref:"vxeForm",attrs:{data:e.formConfig.formData,items:e.formConfig.formItems,rules:e.formConfig.formRules,"title-align":"right","title-width":"150"},on:{submit:e.onSubmit}})]},proxy:!0}])})},a=[],s=(i("1bc7"),i("9f60"),i("94f0"),i("0c84"),i("2843"),i("4057"),i("a450"),i("fc02"),i("e680"),i("11f5")),n=i("b775");function l(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=c(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,n=!0,l=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return n=e.done,e},e:function(e){l=!0,s=e},f:function(){try{n||null==i.return||i.return()}finally{if(l)throw s}}}}function c(e,t){if(e){if("string"===typeof e)return o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}var u={name:"treeContrlPage",props:{breadcrumbList:{type:Array,default:function(){return[]}},tableUrls:{type:Object,default:function(){return{list:{},create:{},update:{},delete:{}}}},formConfig:{type:Object,default:function(){return{formData:{},formItems:[],formRules:{},detailList:[]}}},treeConfig:{type:Object,default:function(){return{url:"",defaultProps:{children:"children",label:"label"},searchId:"id",params:{searchId:{},addChild:{},addbrother:{}}}}},isBreadcrumb:{type:Boolean,default:function(){return!0}},localHeight:{type:Number,default:function(){return 0}},temporaryData:{type:Object,default:function(){return{treeData:[]}}},treeOptions:{type:Object,default:function(){return{parentKey:"pCode",key:"rowCode"}}}},data:function(){return{heardHeight:"40px",footerHeight:"60px",formItemButton:{align:"left",span:24,titleAlign:"left",itemRender:{name:"$buttons",children:[{props:{type:"submit",content:"保存",status:"primary"}},{props:{type:"button",status:"success",content:"新增顶级"},events:{click:this.onCreate}},{props:{type:"button",status:"warning",content:"添加子级"},events:{click:this.onCreateChild}},{props:{type:"button",status:"my-purple",content:"添加同级"},events:{click:this.onCreateBrother}},{props:{type:"button",status:"danger",content:"删除"},events:{click:this.onDelete}}]}},initData:{},query:{page:1,rows:10,wheres:null},treeHeight:500,clickId:0,clickLabel:"当前无选择项",clickLabelValue:"",clickData:{},clickLabelTag:{type:"success",value:"新增"},filterText:"",checked:[],menuTreeData:[]}},created:function(){this.isBreadcrumb||(this.heardHeight="20px",this.footerHeight="0px"),Object(s["b"])(this.formConfig.formData,this.initData);var e=this.getScreen();this.treeHeight=e.height-300-this.localHeight,this.formConfig.formItems=Object(s["a"])(this.formItemButton,this.formConfig.formItems),this.getInit()},methods:{getInit:function(){var e=this;if(!this.emptyValue(this.tableUrls.list.url))return Object(n["a"])({url:this.tableUrls.list.url,method:"post",data:this.query}).then((function(t){e.menuTreeData=e.$utils.toArrayTree(t.rows,e.treeOptions),e.clickId&&e.$nextTick((function(){e.$refs.newTree.setCurrentKey(e.clickId)}))}));this.menuTreeData=this.temporaryData.treeData},onSubmit:function(){var e=this,t=!!this.formConfig.formData[this.treeConfig.searchId],i=null,r=null;if(t?(i=this.tableUrls.update.url,r=this.setForm(this.tableUrls.update.params)):(i=this.tableUrls.create.url,r=this.setForm(this.tableUrls.create.params)),!this.emptyValue(i))return Object(n["a"])({url:i,method:"post",data:r}).then((function(t){t.status?e.$XModal.message({message:t.message,id:"update",status:"success"}):e.$XModal.message({message:t.message,id:"update",status:"error"}),e.getInit();var i=e.clickId;i||(Object(s["b"])(e.initData,e.formConfig.formData),e.setClickArea(6))}))},isSelect:function(){var e=this.clickId;return!!e||(this.$XModal.message({message:"请选择节点",id:"error1"}),!1)},onCreate:function(){Object(s["b"])(this.initData,this.formConfig.formData),this.setClickArea(1)},onCreateChild:function(){var e=this.isSelect();e&&(this.setClickArea(3),this.formConfig.formData=this.setFormKeyValue(this.treeConfig.params.addChild))},onCreateBrother:function(){var e=this.isSelect();e&&(this.setClickArea(4),this.formConfig.formData=this.setFormKeyValue(this.treeConfig.params.addbrother))},onDelete:function(){var e=this,t=this.isSelect(),i=this.clickData;if(t){var r="您确定要删除【"+i[this.treeConfig.defaultProps.label]+"】菜单吗？";this.$XModal.confirm(r).then((function(t){if("confirm"==t){var r=[];if(r.push(i[e.tableUrls.delete.params.delKeys]),!e.emptyValue(e.tableUrls.delete.url))return Object(n["a"])({url:e.tableUrls.delete.url,method:"post",data:r}).then((function(t){t.status?e.$XModal.message({message:"删除成功",id:"delete1",status:"success"}):e.$XModal.message({message:t.message,id:"delete2",status:"warning"}),Object(s["b"])(e.initData,e.formConfig.formData),e.setClickArea(5),e.getInit()}))}}))}},setForm:function(e){var t={},i={mainData:this.formConfig.formData,childList:null,clickId:this.clickId,delKeys:null};for(var r in e)if(e[r])if(e[r].indexOf(".")>=0){var a=e[r].split(".");t[r]=i[a[0]][a[1]]}else t[r]=i[e[r]];else t[r]="";return t},setFormKeyValue:function(e){var t=Object(s["b"])(this.initData),i={mainData:this.formConfig.formData,_null:null,_0:0,_1:1,clickId:this.clickId,clickLabel:this.clickLabel,clickData:this.clickData};for(var r in e)if(e[r])if(e[r].indexOf(".")>=0){var a=e[r].split(".");t[r]=i[a[0]][a[1]]}else t[r]=i[e[r]];else t[r]="";return t},emptyValue:function(e){return null===e||void 0===e||""===e},typeValue:function(e){var t,i=this.searchConfig.formItems,r=l(i);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.field===e&&"$select"==a.itemRender.name)return"drop"}}catch(s){r.e(s)}finally{r.f()}},setClickArea:function(e){this.$refs.vxeForm.reset();var t=this.$refs.newTree,i=this;switch(e){case 1:this.clickId=0,this.clickLabel="当前无选择项",this.clickLabelTag.type="success",this.clickLabelTag.value="新增顶级",i.$nextTick((function(){t.setCurrentKey()}));break;case 2:this.clickLabelTag.type="",this.clickLabelTag.value="编辑";break;case 3:this.clickLabelTag.type="warning",this.clickLabelTag.value="添加子级";break;case 4:this.clickLabelTag.type="info",this.clickLabelTag.value="添加同级";break;case 5:this.clickId=0,this.clickLabel="当前无选择项",this.clickLabelTag.type="success",this.clickLabelTag.value="新增",i.$nextTick((function(){t.setCurrentKey()}));break;default:this.clickId=0,this.clickLabel="当前无选择项";break}},setChecked:function(e){var t=this,i=this;function r(e){if(e.childNodes.length>0)for(var t=0;t<e.childNodes.length;t++){var a=e.childNodes;i.checked.indexOf(a[t].key)>=0&&i.checked.splice(i.checked.indexOf(a[t].key),1),r(a[t])}}e.key&&e.childNodes.length>0&&i.$nextTick((function(){t.checked.indexOf(e.key)>=0?(t.checked.splice(t.checked.indexOf(e.key),1),r(e)):t.checked.push(e.key)}))},filterNode:function(e,t){return!e||-1!==t[this.treeConfig.defaultProps.label].indexOf(e)},onNodeClick:function(e,t,i){var r=this;if(this.clickId=e[this.treeConfig.searchId],this.clickLabel="当前选择：",this.clickLabelValue=e[this.treeConfig.defaultProps.label],this.clickData=e,this.setClickArea(2),this.setChecked(t),!this.emptyValue(this.treeConfig.url)){var a=this.setForm(this.treeConfig.params.searchId);return Object(n["a"])({url:this.treeConfig.url,method:"post",data:a}).then((function(e){e.status?r.formConfig.formData=e:r.$XModal.message({message:e.message,id:"delete",status:"warning"})}))}this.formConfig.formData=Object(s["b"])(e),this.$emit("onNodeClick",this.clickData)}},watch:{filterText:function(e){this.$refs.newTree.filter(e)},clickLabel:function(e){"当前无选择项"==e&&(this.clickLabelValue="")}}},f=u,h=(i("4b9b"),i("c701")),d=Object(h["a"])(f,r,a,!1,null,"233a0988",null);t["default"]=d.exports},"4b9b":function(e,t,i){"use strict";i("5c21")},"5c21":function(e,t,i){}}]);